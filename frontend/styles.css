/* ========== Pastel Cute Theme ========== */
:root{
  --bg: #f9fbff;
  --bg-2: #f4f7ff;
  --fg: #0f172a;
  --muted:#6b7280;

  --card:#ffffffcc;
  --glass:#ffffffa8;
  --border:#e6ecff;
  --ring:#9b8cff;

  --accent-1:#ff9ec8;   /* pink */
  --accent-2:#9b8cff;   /* lavender */
  --accent-3:#7dd3fc;   /* sky */
  --accent-4:#a7f3d0;   /* mint */
  --accent-5:#fde68a;   /* lemon */

  --shadow: 0 10px 32px rgba(55, 65, 81, .12), 0 2px 8px rgba(55,65,81,.06);
  --radius:18px; --radius-sm:14px; --radius-xs:10px;
  --space-1:.25rem; --space-2:.5rem; --space-3:.75rem; --space-4:1rem; --space-5:1.25rem; --space-6:1.5rem; --space-8:2rem;

  --text-base: clamp(14px, .9vw + .55rem, 16px);
  --text-sm: clamp(12px, .7vw + .45rem, 14px);
  --text-lg: clamp(16px, 1.1vw + .75rem, 19px);

  color-scheme: light;
}
@media (prefers-color-scheme: dark){
  :root{
    --bg: #0b1120;
    --bg-2:#0f172a;
    --fg: #e5e7eb;
    --muted:#94a3b8;

    --card:#0f172acc;
    --glass:#0f172ab8;
    --border:#1e293b;
    --ring:#a78bfa;

    --shadow: 0 16px 36px rgba(0,0,0,.35), 0 2px 10px rgba(0,0,0,.25);
    color-scheme: dark;
  }
}

/* ========== Base ========== */
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background:
    radial-gradient(1200px 600px at -10% -20%, color-mix(in srgb, var(--accent-2) 10%, transparent), transparent 60%),
    radial-gradient(1000px 700px at 120% 10%, color-mix(in srgb, var(--accent-1) 10%, transparent), transparent 55%),
    linear-gradient(180deg, var(--bg), var(--bg-2));
  color:var(--fg);
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  font-size: var(--text-base);
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  overflow-x:hidden;
}

/* Floating background decor */
.bg-decor{ position:fixed; inset:0; pointer-events:none; z-index:0 }
.blob{
  position:absolute; filter: blur(60px); opacity:.6; mix-blend-mode: plus-lighter;
  border-radius: 50%;
  animation: float 8s ease-in-out infinite alternate;
}
.blob.b1{ width:360px; height:360px; left:-80px; top:-80px; background:linear-gradient(120deg, var(--accent-1), var(--accent-2)); }
.blob.b2{ width:300px; height:300px; right:-60px; top:10%; background:linear-gradient(120deg, var(--accent-3), var(--accent-4)); animation-duration: 10s; }
.blob.b3{ width:260px; height:260px; left:10%; bottom:-80px; background:linear-gradient(120deg, var(--accent-5), var(--accent-1)); animation-duration: 12s; }
@keyframes float{ to { transform: translateY(30px) translateX(20px) scale(1.04); } }
.sparkles{
  position:absolute; inset:0; background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,.5) 0 1px, transparent 2px),
    radial-gradient(circle at 70% 60%, rgba(255,255,255,.5) 0 1px, transparent 2px),
    radial-gradient(circle at 40% 80%, rgba(255,255,255,.5) 0 1px, transparent 2px);
  opacity:.35; animation: twinkle 3s ease-in-out infinite alternate;
}
@keyframes twinkle{ to { opacity:.15; transform:translateY(-3px) } }

.container{ max-width:1200px; margin:0 auto; padding: 0 var(--space-4); position:relative; z-index:1; }
.row{ display:flex; align-items:center; gap:var(--space-3); padding: .9rem 0; flex-wrap:wrap }

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:5;
  backdrop-filter:saturate(1.2) blur(10px);
  background: color-mix(in srgb, var(--glass) 92%, transparent);
  border-bottom: 1px dashed color-mix(in srgb, var(--border) 85%, transparent);
}
.brand{ display:flex; align-items:center; gap:.6rem }
.logo{
  width:34px; height:34px; display:grid; place-items:center; font-size:18px;
  background: linear-gradient(135deg, var(--accent-2), var(--accent-1));
  border:1px solid color-mix(in srgb, var(--border) 70%, transparent);
  border-radius: 10px; box-shadow: var(--shadow);
}
h1{ margin:0; font-weight:900; letter-spacing:.2px; font-size: clamp(1.05rem, 1.1rem + .3vw, 1.35rem);}
.badge{
  font-size:.72rem; font-weight:800; padding:.2rem .5rem; margin-left:.4rem; border-radius:999px;
  background: linear-gradient(90deg, var(--accent-3), var(--accent-4));
  color:#0b1220; border:1px solid color-mix(in srgb, #ffffff 50%, transparent);
}
.top-meta{ display:flex; gap:.4rem; flex-wrap:wrap }
.chip{
  font-size:.78rem; border-radius:999px; padding:.25rem .6rem; background:var(--glass);
  border:1px dashed color-mix(in srgb, var(--border) 85%, transparent);
}

/* Layout */
.grid{ display:grid; gap:var(--space-4); grid-template-columns: 1fr; padding: var(--space-4) 0 var(--space-4) }
@media (min-width:1024px){
  .grid{ grid-template-columns: minmax(0, 2fr) minmax(320px, 1fr) }
}
.rightpanel .sticky{ position:sticky; top:84px; }

/* Cards */
.card{
  background: var(--card);
  border:1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: clip;
}
.card.pop{ animation: cardIn .28s cubic-bezier(.2,.8,.2,1) }
@keyframes cardIn{ from{ transform: translateY(8px) scale(.995); opacity:0 } to{ transform:none; opacity:1 } }
.card-head{
  padding: .9rem var(--space-4);
  background:
   linear-gradient(180deg, color-mix(in srgb, var(--glass) 90%, transparent), transparent),
   repeating-linear-gradient(45deg, transparent 0 10px, color-mix(in srgb, var(--border) 35%, transparent) 10px 12px);
  border-bottom:1px dashed var(--border);
}
h2{ margin:0; font-size: var(--text-lg); font-weight:900; letter-spacing:.2px }
h2 .sub{ font-size:.85em; font-weight:600; color:var(--muted); margin-left:.5rem }
.card .content{ padding: var(--space-4) }

/* Inputs */
.lbl{ display:block; font-size:.9rem; color:var(--muted); margin:0 0 .35rem; font-weight:700 }
input[type="text"], input[type="number"], input[type="datetime-local"], select, textarea{
  width:100%; padding:.72rem .9rem;
  border:1px solid var(--border); border-radius: var(--radius-sm);
  background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 92%, transparent), var(--glass));
  color:var(--fg); box-shadow: inset 0 1px 0 rgba(255,255,255,.35);
  transition: border-color .2s, box-shadow .2s, transform .12s;
}
textarea{ resize:vertical; min-height:2.5rem }
input::placeholder, textarea::placeholder{ color: color-mix(in srgb, var(--muted) 80%, transparent) }
:where(input,select,textarea):focus-visible{
  outline:none; border-color: var(--ring);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--ring) 30%, transparent), inset 0 1px 0 rgba(255,255,255,.35);
  transform: translateY(-1px);
}

/* Input with prefix */
.input-wrap{ position:relative }
.input-wrap .prefix{
  position:absolute; left:.6rem; top:50%; transform:translateY(-50%);
  font-weight:800; color: color-mix(in srgb, var(--muted) 70%, transparent);
}
.input-wrap input{ padding-left: 2rem }

/* Buttons */
button{
  padding:.7rem 1rem; border-radius: 16px; border:1px solid color-mix(in srgb, var(--border) 70%, transparent);
  background: linear-gradient(180deg, color-mix(in srgb, var(--accent-2) 95%, #000 0%), var(--accent-2));
  color:#fff; font-weight:900; letter-spacing:.2px; cursor:pointer;
  transition: transform .16s, box-shadow .2s, background .2s;
  position:relative; isolation:isolate;
}
button:hover{ transform: translateY(-1px) scale(1.01); box-shadow: 0 12px 28px rgba(155,140,255,.25) }
button:active{ transform: translateY(0); }
button.pill{ border-radius:999px }
button.big{ font-size:1.05rem }
button.btn-candy{
  background: linear-gradient(135deg, var(--accent-1), var(--accent-3), var(--accent-2));
  text-shadow: 0 1px 0 rgba(0,0,0,.12);
}
button.outline{
  background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 92%, transparent), var(--glass));
  color:var(--fg);
}
button[disabled]{ opacity:.6; cursor:not-allowed; box-shadow:none }
button::after{
  content:""; position:absolute; inset:auto; width:0; height:0; border-radius:50%;
  background: radial-gradient(circle, rgba(255,255,255,.7), transparent 60%);
  transform: translate(-50%, -50%); pointer-events:none;
}
button:active::after{ width:120px; height:120px; opacity:.5; left:50%; top:50%; transition: width .25s ease, height .25s ease }

/* Dropzone */
.dropzone{
  border:2px dashed var(--border); border-radius: var(--radius);
  padding: var(--space-5); text-align:center; background: color-mix(in srgb, var(--glass) 94%, transparent);
  transition:border-color .2s, box-shadow .2s, background .2s;
  position:relative; overflow:hidden;
}
.dropzone::before{
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(750px 120px at 10% 0%, color-mix(in srgb, var(--accent-3) 18%, transparent), transparent 60%),
    radial-gradient(750px 120px at 90% 0%, color-mix(in srgb, var(--accent-1) 18%, transparent), transparent 60%);
  opacity:.35; pointer-events:none;
}
.dropzone:hover{ border-color: var(--ring); box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--ring) 18%, transparent) }
.dropzone .dz-ico{ font-size:28px; }
.dropzone .dz-title{ font-weight:900; font-size:1.05rem; margin-top:.25rem }
.dropzone .dz-sub{ font-size:.9rem; color:var(--muted) }
.dropzone input[type=file]{
  display:block; margin:.6rem auto 0; width:100%;
  padding:.4rem; border-radius:12px; background:var(--glass); border:1px dashed var(--border);
}
.dropzone img{
  margin:.8rem auto 0; max-height:280px; display:block; border-radius:14px;
  border:1px solid var(--border); background:var(--glass);
}

/* Form layout */
.form-grid{ display:grid; gap: var(--space-4) }
.form-block{ display:block }
.form-actions{ display:flex; gap:.6rem; flex-wrap:wrap; justify-content:flex-start }

/* Table */
.table-wrap{ border:1px solid var(--border); border-radius: var(--radius-sm); overflow:auto; background: color-mix(in srgb, var(--glass) 94%, transparent) }
table{ width:100%; border-collapse:separate; border-spacing:0; table-layout: fixed; }
th, td{
  padding:.65rem .7rem; border-top:1px dashed var(--border); text-align:left; vertical-align:middle; word-break:break-word;
}
th{
  position:sticky; top:0; z-index:1; background: color-mix(in srgb, var(--card) 98%, transparent); border-top:none;
  font-weight:900; color:#475569;
}
tbody tr:hover{ background: color-mix(in srgb, var(--glass) 90%, transparent) }
.table-input{
  width:100%; padding:.5rem .6rem; border:1px solid var(--border); border-radius:12px;
  background: var(--glass); color:var(--fg); font-size:.94rem;
}
.table-input:focus-visible{ outline:none; border-color: var(--ring); box-shadow: 0 0 0 3px color-mix(in srgb, var(--ring) 28%, transparent) }

/* Tag */
.tag{
  display:inline-block; padding:.28rem .7rem; border-radius:999px; font-weight:900; letter-spacing:.2px; cursor:pointer;
  background:#f5f3ff; color:#3730a3; border:1px solid color-mix(in srgb, #a78bfa 30%, var(--border));
  transition: transform .16s, box-shadow .2s, background .2s;
}
.tag:hover{ transform: translateY(-1px); box-shadow: 0 10px 20px rgba(167,139,250,.25) }

/* Stats */
.stats{ display:grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-3) }
.stats.cute .stat{
  border:1px dashed var(--border); border-radius:18px; padding:.9rem; text-align:center;
  background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 95%, transparent), var(--glass));
  position:relative; overflow:hidden;
}
.stats.cute .stat::after{
  content:""; position:absolute; inset:auto; width:120%; height:60px; left:-10%; top:-10px;
  background: linear-gradient(90deg, color-mix(in srgb, #fff 60%, transparent), transparent);
  opacity:.35; filter: blur(10px); transform: rotate(3deg);
}
.stat-ico{ font-size:1.2rem; margin-bottom:.1rem }
.stat-title{ font-size:.85rem; color:var(--muted); font-weight:800 }
.stat-num{ font-size:1.05rem; font-weight:900 }
.stats.compact .stat{ padding:.7rem }
.stats.compact .stat-num{ font-size:1rem }

/* Chart card */
.chart-card{
  margin-top: .6rem; border:1px dashed var(--border); border-radius: var(--radius-sm);
  background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 95%, transparent), var(--glass));
  overflow:hidden; position:relative;
  padding: .5rem;
}
#pie{ width:100%; height:260px; display:block }
.chart-card .center{ text-align:center; padding:.6rem 0 }

/* Helpers */
.muted{ color: var(--muted); font-size:.92rem }
.error{ color:#b91c1c; margin-top:.5rem }
.spacer{ flex:1 }

/* Responsive */
@media (max-width:1023px){
  /* แสดงสรุปผลบนมือถือ และวางต่อท้ายคอนเทนต์หลัก */
  .rightpanel{ display:block; margin-top: var(--space-4); }
  .rightpanel .sticky{ position:static; top:auto; }
  .grid{ grid-template-columns: 1fr }
}
@media (min-width:1024px){
  .rightpanel{ display:block }
}
@media (max-width:640px){
  .container{ padding:0 var(--space-3) }
  .row{ padding:.6rem 0 }
  .stats{ grid-template-columns: 1fr 1fr 1fr }
  #pie{ height:240px }
  th, td{ padding:.55rem .5rem; font-size:.9rem; }
  .dropzone img{ max-height:220px; }
  .form-actions > button{ flex:1 1 48%; min-width:0; }
}
@media (max-width:480px){
  .stats{ grid-template-columns: 1fr }
  #pie{ height:220px }
  .form-actions{ flex-direction:column; }
  .form-actions > button{ width:100%; }
  th, td{ font-size:.88rem; }
}

/* Touch-friendly targets on mobile */
:where(input[type="text"], input[type="number"], input[type="datetime-local"], select, textarea, button){
  min-height:44px;
  -webkit-tap-highlight-color: transparent;
}

/* Better table wrapping and momentum scroll on iOS */
.table-wrap{
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: contain;
}
th, td{
  overflow-wrap:anywhere;
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important }
}